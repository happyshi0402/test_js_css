var currentSelIndex=-1;var oldSelIndex=-1;$(function(){$(document).click(function(){$("ul.GL_filterTip").hide()});var a=$("input.GL_filterTip");for(var b=0;b<a.length;b++){$("<ul id='"+a[b].id+"_ul' class='GL_filterTip' onclick='GL_filterTipOnClickHandler(this,event)'></ul>").insertAfter("#"+a[b].id)}});function GL_filterTipClickHandler(e,d,b,a){GL_filterTipAutoComplete(e,b,a);GL_filterTipReSetSelIndex(e);var c=d||window.event;if(c.stopPropagation){c.stopPropagation()}else{if(window.event){window.event.cancelBubble=true}}}function GL_filterTipKeyUpHandler(d,c,b,a){if(d.value==""){GL_filterTipAutoComplete(d,b,a);GL_filterTipReSetSelIndex(d)}else{if(!($("#"+d.id+"_ul").css("display")!="none"&&(c.keyCode==38||c.keyCode==40||c.keyCode==13))){GL_filterTipAutoComplete(d,b,a);GL_filterTipReSetSelIndex(d)}}}function GL_filterTipAutoComplete(c,b,a){$.ajax({url:b,type:"POST",data:{q:c.value},success:function(f){var d=JSON.parse(f);$("#"+c.id+"_ul").empty();if(c.getAttribute("self_designed_type")=="new_patient"){for(var e=0;e<d.length;e++){$("<li id='"+c.id+"_ul_li"+e+"' alternativeTarget='"+c.getAttribute("alternativeTarget")+"'>"+d[e][a]+"</li>").appendTo($("#"+c.id+"_ul"))}if($(c).attr("alternativeTarget")){$("<li id='"+c.id+"_ul_li_new'  alternativeTarget='"+c.getAttribute("alternativeTarget")+"'>新建病案号："+c.value+"</li>").appendTo($("#"+c.id+"_ul"))}}else{for(var e=0;e<d.length;e++){$("<li id='"+c.id+"_ul_li"+e+"'>"+d[e][a]+"</li>").appendTo($("#"+c.id+"_ul"))}}$("#"+c.id+"_ul").show()},error:function(){alert("http request fail")}})}function GL_filterTipOnClickHandler(c,b){if($("#"+c.id.substr(0,c.id.length-3))[0].getAttribute("self_designed_type")=="new_patient"){if(b.target.getAttribute("id").split("li_")[1]!="new"){switch(navigator.appCodeName){case"Mozilla":$("#"+c.id.substr(0,c.id.length-3)).val(b.target.textContent);break;default:$("#"+c.id.substr(0,c.id.length-3)).val(b.target.innerText)}}else{var a=b||window.event;if(a.stopPropagation){a.stopPropagation()}else{if(window.event){window.event.cancelBubble=true}}}$("#"+c.id).hide();GL_filterTipReSetSelIndex($("#"+c.id.substr(0,c.id.length-3))[0]);$(b.target.getAttribute("alternativeTarget")).click()}else{if($("#"+c.id.substr(0,c.id.length-3))[0].getAttribute("self_designed_type")=="copy_sample"){switch(navigator.appCodeName){case"Mozilla":$("#"+c.id.substr(0,c.id.length-3)).val(b.target.textContent);copy(b.target.textContent);break;default:$("#"+c.id.substr(0,c.id.length-3)).val(b.target.innerText);copy(b.target.innerText)}$("#"+c.id).hide();$("#"+c.id.substr(0,c.id.length-3)).val("")}else{if($("#"+c.id.substr(0,c.id.length-3))[0].getAttribute("self_designed_type")=="move_sample"){switch(navigator.appCodeName){case"Mozilla":$("#"+c.id.substr(0,c.id.length-3)).val(b.target.textContent);move(b.target.textContent);break;default:$("#"+c.id.substr(0,c.id.length-3)).val(b.target.innerText);move(b.target.innerText)}$("#"+c.id).hide();$("#"+c.id.substr(0,c.id.length-3)).val("")}else{if($("#"+c.id.substr(0,c.id.length-3))[0].getAttribute("self_designed_type")=="add_phenotype_tag-cloud"){switch(navigator.appCodeName){case"Mozilla":$("#"+c.id.substr(0,c.id.length-3)).val(b.target.textContent);add_phenotype_tag_cloud(b.target.textContent);break;default:$("#"+c.id.substr(0,c.id.length-3)).val(b.target.innerText);add_phenotype_tag_cloud(b.target.innerText)}$("#"+c.id).hide();$("#"+c.id.substr(0,c.id.length-3)).val("")}else{switch(navigator.appCodeName){case"Mozilla":$("#"+c.id.substr(0,c.id.length-3)).val(b.target.textContent);break;default:$("#"+c.id.substr(0,c.id.length-3)).val(b.target.innerText)}$("#"+c.id).hide();GL_filterTipReSetSelIndex($("#"+c.id.substr(0,c.id.length-3))[0])}}}}}function GL_filterTipReSetSelIndex(a){currentSelIndex=-1;oldSelIndex=-1};